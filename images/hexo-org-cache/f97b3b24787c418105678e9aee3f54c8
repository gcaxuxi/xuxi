{"md5":"5b12ee9a4aac051ffd9cd0e3c9577eb5","content":"\n<div id=\"outline-container-sec-1\" class=\"outline-2\">\n<h2 id=\"sec-1\"><span class=\"section-number-2\">1</span> &#x524D;&#x8A00;</h2>\n<div class=\"outline-text-2\" id=\"text-1\">\n<p>\nLSTM&#x7684;&#x6A21;&#x578B;&#x5230;&#x5904;&#x90FD;&#x6709;&#x4ECB;&#x7ECD;&#xFF0C;&#x5176;&#x4E2D;&#x4ECB;&#x7ECD;&#x5F97;&#x6BD4;&#x8F83;&#x597D;&#x7684;&#x6BD4;&#x5982;Olah&#x7684;&#x535A;&#x5BA2;<a href=\"http://colah.github.io/posts/2015-08-Understanding-LSTMs/\">Understanding LSTM Networks</a>&#x3002;&#x7531;&#x4E8E; <b>Backpropagation through time</b> (BPTT) &#x76F8;&#x5BF9;&#x4E8E;&#x4F20;&#x7EDF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x590D;&#x6742;&#x4E86;&#x4E00;&#x4E9B;&#xFF0C;&#x5F88;&#x5C11;&#x6709;&#x4EBA;&#x5B8C;&#x6574;&#x5730;&#x628A;&#x63A8;&#x5BFC;&#x8FC7;&#x7A0B;&#x6652;&#x51FA;&#x6765;&#xFF0C;&#x5F88;&#x591A;&#x4EBA;&#x5B9E;&#x73B0;LSTM&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x90FD;&#x501F;&#x52A9;&#x4E8E;&#x81EA;&#x52A8;&#x5FAE;&#x5206;&#xFF08;auto differantiation&#xFF09;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x4ECE;&#x800C;&#x907F;&#x5F00;&#x4E86;&#x624B;&#x52A8;&#x63A8;&#x5BFC;BPTT&#x7684;&#x9EBB;&#x70E6;&#x3002;&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x5C06;&#x4E0D;&#x6015;&#x9EBB;&#x70E6;&#xFF0C;&#x628A;&#x6574;&#x4E2A;BPTT&#x7684;&#x63A8;&#x5BFC;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;&#xFF0C;&#x8FD9;&#x6837;&#x5B50;&#x53EF;&#x4EE5;&#x52A0;&#x6DF1;&#x521D;&#x5B66;&#x8005;&#xFF08;&#x5305;&#x62EC;&#x6211;&#x81EA;&#x5DF1;&#xFF09;&#x7684;&#x7406;&#x89E3;&#x3002;\n</p>\n</div>\n</div>\n\n<div id=\"outline-container-sec-2\" class=\"outline-2\">\n<h2 id=\"sec-2\"><span class=\"section-number-2\">2</span> &#x6A21;&#x578B;</h2>\n<div class=\"outline-text-2\" id=\"text-2\">\n<p>\n&#x6211;&#x4EEC;&#x5148;&#x628A;&#x6A21;&#x578B;&#x786E;&#x5B9A;&#x4E0B;&#x6765;&#xFF0C;\n</p>\n\n<ul class=\"org-ul\">\n<li>&#x8F93;&#x5165; &#x8BCD;&#x5411;&#x91CF; \\(x_t \\in \\mathbb{R}^w\\),\n</li>\n\n<li>LSTM&#x5C42;  \n</li>\n</ul>\n\n\\begin{equation}\n\\begin{aligned}\n&amp; i = \\sigma(U^ix_t + W^is_{t-1} + b^i) \\\\\n&amp; f = \\sigma(U^fx_t + W^fs_{t-1} + b^f) \\\\\n&amp; o = \\sigma(U^ox_t + W^os_{t-1} + b^o) \\\\\n&amp; g = \\tanh(U^gx_t + W^gs_{t-1} + b^g) \\\\\n&amp; c_t = c_{t-1} \\circ f + g \\circ i \\\\\n&amp; s_t = \\tanh(c_t) \\circ o\n\\end{aligned}\n\\end{equation}\n\n<ul class=\"org-ul\">\n<li>&#x8F93;&#x51FA;&#x5C42; \n</li>\n</ul>\n\n<p>\n$$\n\\hat{y}_t = \\mathrm{softmax}(Vs_t + b^V)\n$$\n</p>\n</div>\n</div>\n\n<div id=\"outline-container-sec-3\" class=\"outline-2\">\n<h2 id=\"sec-3\"><span class=\"section-number-2\">3</span> &#x68AF;&#x5EA6;</h2>\n<div class=\"outline-text-2\" id=\"text-3\">\n<p>\n&#x663E;&#x7136;&#xFF0C;&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x8F93;&#x5165; \\(x_1,x_2,\\cdots,x_T\\) &#xFF0C;&#x6700;&#x540E;&#x7684;error \\(E = E_1 + \\cdots + E_T\\) &#xFF0C;&#x56E0;&#x6B64;&#x5BF9;&#x53C2;&#x6570;&#x7684;&#x68AF;&#x5EA6;&#xFF0C;&#x6BD4;&#x5982;&#x5BF9; \\(W^f\\) &#x7684;&#x68AF;&#x5EA6;&#xFF0C;&#x4E5F;&#x662F;&#x6C42;&#x548C;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5373;\n$$\n\\frac{\\partial E}{\\partial W^f} = \\sum_t \\frac{\\partial E_t}{\\partial W^f}\n$$\n</p>\n\n<p>\n&#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x6765;&#x8003;&#x8651;&#x7279;&#x5B9A;&#x65F6;&#x523B;&#x7684;error \\(E_t\\) .\n</p>\n</div>\n\n<div id=\"outline-container-sec-3-1\" class=\"outline-3\">\n<h3 id=\"sec-3-1\"><span class=\"section-number-3\">3.1</span> &#x8F93;&#x51FA;&#x5C42;</h3>\n<div class=\"outline-text-3\" id=\"text-3-1\">\n<p>\n&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x8F93;&#x51FA;&#x5C42;&#xFF0C;&#x8F93;&#x51FA;&#x5C42;&#x7684;&#x68AF;&#x5EA6;&#x76F8;&#x5BF9;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x6211;&#x4EEC;&#x5148;&#x4ECE;&#x8FD9;&#x91CC;&#x5F00;&#x59CB;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x539F;&#x56E0;&#x5219;&#x662F;&#x56E0;&#x4E3A;&#x8FD9;&#x91CC;&#x662F;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7684;&#x7B2C;&#x4E00;&#x7AD9;&#x3002;\n</p>\n\n<p>\n&#x8F93;&#x51FA;&#x5C42;&#x662F;&#x4E00;&#x4E2A;softmax&#x51FD;&#x6570;&#xFF0C;&#x8868;&#x8FBE;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;\n</p>\n\n<p>\n$$\\hat{y}_t = \\mathrm{softmax}(Vs_t + b^V)$$\n</p>\n\n<p>\n&#x8003;&#x8651;&#x65F6;&#x523B; \\(t\\) &#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;\\(E_t\\), \n</p>\n\n<p>\n$$\nE_t = -y_t \\log \\hat{y}_t\n$$\n</p>\n\n<p>\n&#x5176;&#x4E2D; \\(y_t\\) &#x662F; label &#x5411;&#x91CF;&#xFF0C;&#x53EA;&#x5728;&#x6B63;&#x786E;&#x7684;&#x90A3;&#x4E2A;&#x7EF4;&#x5EA6;&#x4E0A;&#x4E3A;1&#xFF0C;&#x5176;&#x4ED6;&#x5747;&#x4E3A;0&#x3002;\n</p>\n\n<p>\n&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B; \\(E_t\\) &#x5BF9; \\(b^V\\) &#x6C42;&#x5BFC;&#x3002;\n</p>\n\n<p>\n$$\n\\frac{\\partial E_t}{\\partial b^V} = \\sum_k \\frac{\\partial E_t}{\\partial \\hat{y}^k_t}\\frac{\\partial \\hat{y}^k_t}{\\partial b^V}\n$$\n</p>\n\n<p>\n&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;, &#x4E0A;&#x6807; \\(k\\) &#x5728;  \\(\\hat{y}^k_t\\) &#x91CC;&#x9762;&#x8868;&#x793A;&#x5411;&#x91CF;&#x7684;&#x7B2C;k&#x4E2A;&#x5206;&#x91CF;&#x3002;\n</p>\n\n<p>\n&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;, &#x5728; \\(y_t\\) &#x4E3A;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5206;&#x91CF;&#x4E3A;1&#xFF0C;&#x5176;&#x4ED6;&#x5747;&#x4E3A;0&#x7684;&#x5411;&#x91CF;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;\\(E_t\\) &#x5BF9; \\(\\hat{y}\\) &#x7684;&#x68AF;&#x5EA6;&#x4E5F;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x975E;0, &#x5047;&#x8BBE;&#x8FD9;&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x4E0B;&#x6807;&#x4E3A; \\(m\\) &#xFF0C;\n</p>\n\n<p>\n&#x4E5F;&#x5C31;&#x662F;\n</p>\n\n\\begin{equation}\n\\frac{\\partial E_t}{\\partial \\hat{y}_t^k} = \n\\begin{cases}\n0 &amp; k \\ne m \\\\\n-\\frac{1}{\\hat{y}_t^k} &amp; k = m\n\\end{cases}\n\\end{equation}\n\n<p>\n&#x4EE4; \\(z_t = Vs_t + b^V\\) &#xFF0C; \n</p>\n\n<p>\n&#x5219;\n</p>\n\n\\begin{equation}\n\\frac{\\partial E_t}{\\partial b^V} = -\\frac{1}{\\hat{y}_t^m} \\frac{\\partial \\hat{y}^m_t}{\\partial b^V}\n\\end{equation}\n\n\\begin{equation}\n\\frac{\\partial \\hat{y}^m_t}{\\partial b^V} = \\sum_k\\frac{\\partial \\hat{y}^m_t}{\\partial z_t^k} \\frac{\\partial z_t^k}{\\partial b^V}\n\\end{equation}\n\n<p>\n&#x4ECE;softmax&#x51FD;&#x6570;&#x7684;&#x6C42;&#x5BFC;&#x7ED3;&#x679C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5F97;&#x5230;\n</p>\n\n\\begin{equation}\n\\frac{\\partial E_t}{\\partial z_t^k} = \n\\begin{cases}\n\\hat{y}_t^{(m)} - 1 &amp; k = m \\\\\n\\hat{y}^{(k)}_t &amp; k \\ne m\n\\end{cases}\n\\end{equation}\n\n<p>\n&#x5373;\n</p>\n\n<p>\n$$\n\\frac{\\partial E_t}{\\partial z_t} = \\hat{y}_t - y_t\n$$\n</p>\n\n<p>\n&#x53C8;&#x56E0;&#x4E3A;\n</p>\n\n\\begin{equation}\n\\frac{\\partial z_t^{(k)} }{\\partial b^{(n)} } = \\delta_{kn}\n\\end{equation}\n\n<p>\n&#x6240;&#x4EE5;\n</p>\n\n<p>\n$$\n\\frac{\\partial E_t}{\\partial b^V} = \\sum_k\\frac{\\partial E_t}{\\partial z_t^{(k)}} e_k = \\hat{y}_t - y_t\n$$\n</p>\n\n<p>\n&#x5176;&#x4E2D; \\(e_k\\) &#x4E3A;&#x7B2C;k&#x4E2A;&#x5143;&#x7D20;&#x4E3A;1&#xFF0C;&#x5176;&#x4F59;&#x90FD;&#x662F;0&#x7684;&#x5411;&#x91CF;&#x3002;\n</p>\n\n<!--more-->\n\n\n<div class=\"figure\">\n<p><img src=\"http://xuehy.github.io/images/01.jpg\" alt=\"01.jpg\" width=\"200px\">\n</p>\n</div>\n\n\n<div class=\"figure\">\n<p><img src=\"http://xuehy.github.io/images/02.jpg\" alt=\"02.jpg\" width=\"200px\" align=\"left\" title=\"The tile of picture without figure number\">\n</p>\n</div>\n</div>\n</div>\n<div id=\"outline-container-sec-3-2\" class=\"outline-3\">\n<h3 id=\"sec-3-2\"><span class=\"section-number-3\">3.2</span> LSTM</h3>\n<div class=\"outline-text-3\" id=\"text-3-2\">\n<p>\n(&#x672A;&#x5B8C;)\n</p>\n</div>\n</div>\n</div>\n"}
